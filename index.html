<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRSD AI Executive Office</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- Include Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-blue: #00A99D;
            --dark-teal: #004F58;
            --text-light: #e0e0e0;
            --text-dark: #ffffff;
            --border-color: rgba(255, 255, 255, 0.2);
            --container-bg: rgba(0, 30, 60, 0.5);
            --container-bg-light: rgba(255, 255, 255, 0.08);
            --vh: 1vh;
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        * {
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--dark-teal);
            color: var(--text-light);
            background-image: url('https://images.unsplash.com/photo-1550745165-9bc0b252726a?q=80&w=1920&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            min-height: calc(var(--vh, 1vh) * 100);
        }

        body::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(0, 79, 88, 0.1) 0%, rgba(0, 79, 88, 0.8) 70%, #00282d 100%);
            z-index: -1;
        }

        .header, .nav-tabs-container {
            background-color: transparent;
            backdrop-filter: blur(15px);
            position: sticky;
            z-index: 900;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            border-bottom: 1px solid var(--border-color);
            top: 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .header-left, .header-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .header-left img.hrsd-logo {
            height: 50px;
            width: auto;
        }
        .header-left span { font-weight: 500; font-size: 1.2rem; }

        .header-right .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .header-right .user-profile img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--primary-blue);
        }

        .header-right .user-profile span { font-weight: 500; }
        .header-right button {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.1rem;
            cursor: pointer;
            padding: 5px;
            transition: color 0.2s;
        }
        .header-right button:hover {
            color: var(--primary-blue);
        }

        .mobile-menu-btn { display: none; }

        .nav-tabs-container {
            display: flex;
            justify-content: center;
            padding: 5px 0;
            border-bottom: 1px solid var(--border-color);
            top: 83px; /* Adjusted based on typical header height */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .nav-tabs {
            display: flex;
            gap: 0;
        }

        .nav-tab {
            padding: 15px 30px;
            background-color: transparent;
            color: var(--text-light);
            border: none;
            cursor: pointer;
            font-weight: 500;
            font-size: 1rem;
            transition: all 0.3s ease;
            position: relative;
            border-bottom: 3px solid transparent;
        }

        .nav-tab::after {
            content: '';
            position: absolute;
            bottom: 0; left: 0; right: 0;
            height: 3px;
            background-color: var(--primary-blue);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .nav-tab.active::after {
            transform: scaleX(1);
        }

        .nav-tab:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .nav-tab.active {
            color: var(--text-dark);
            font-weight: 600;
            background-color: rgba(0, 169, 157, 0.1);
        }

        .page-content {
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .page-content.active {
            display: block;
            animation: fadeIn 0.5s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            flex: 1;
            padding: 30px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .grid {
            display: grid;
            gap: 25px;
        }

        .grid.two-col { grid-template-columns: 1fr 1fr; }
        .grid.three-col { grid-template-columns: repeat(3, 1fr); }
        .grid.four-col { grid-template-columns: repeat(4, 1fr); }

        .card {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-5px);
            border-color: var(--primary-blue);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: var(--primary-blue);
        }

        /* Dashboard Page */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(0, 169, 157, 0.2) 0%, rgba(0, 79, 88, 0.3) 100%);
            backdrop-filter: blur(15px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 169, 157, 0.3);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin: 10px 0 5px 0;
        }

        .stat-label {
            font-size: 0.95rem;
            color: var(--text-light);
            opacity: 0.9;
        }

        .stat-icon {
            font-size: 2rem;
            color: var(--primary-blue);
            opacity: 0.7;
        }

        /* Focus Areas */
        .topics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .topic-card {
            background: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .topic-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-blue), #00d4c7);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .topic-card:hover::before {
            transform: scaleX(1);
        }

        .topic-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-blue);
        }

        .topic-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .topic-icon {
            width: 45px;
            height: 45px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-blue), #00d4c7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            color: white;
        }

        .topic-status {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            background-color: rgba(0, 169, 157, 0.2);
            color: var(--primary-blue);
            border: 1px solid var(--primary-blue);
        }

        .topic-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
        }

        .topic-description {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 15px;
            line-height: 1.5;
            opacity: 0.9;
        }

        .topic-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .topic-action-btn {
            padding: 8px 14px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-light);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .topic-action-btn:hover {
            background-color: var(--primary-blue);
            border-color: var(--primary-blue);
            color: white;
            transform: scale(1.05);
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        /* Agent Page */
        .agent-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 25px;
            height: calc(100vh - 200px);
        }

        .personas-panel {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .persona-card {
            background-color: var(--container-bg-light);
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 15px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .persona-card:hover {
            border-color: var(--primary-blue);
            background-color: rgba(0, 169, 157, 0.1);
        }

        .persona-card.active {
            border-color: var(--primary-blue);
            background-color: rgba(0, 169, 157, 0.15);
        }

        .persona-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .persona-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--primary-blue);
        }

        .persona-info h3 {
            margin: 0;
            font-size: 1.05rem;
            color: var(--text-dark);
        }

        .persona-info p {
            margin: 2px 0 0 0;
            font-size: 0.85rem;
            color: var(--text-light);
            opacity: 0.8;
        }

        .persona-description {
            font-size: 0.9rem;
            color: var(--text-light);
            line-height: 1.4;
            margin-top: 8px;
        }

        .chat-panel {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header-left h2 {
            margin: 0;
            font-size: 1.3rem;
            color: var(--text-dark);
        }

        .chat-header-left p {
            margin: 5px 0 0 0;
            font-size: 0.9rem;
            color: var(--text-light);
            opacity: 0.8;
        }

        .change-persona-btn {
            padding: 10px 20px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .change-persona-btn:hover {
            background-color: #008f85;
            transform: scale(1.05);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            display: flex;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .message-content {
            max-width: 70%;
            background-color: var(--container-bg-light);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .message.user-message {
            flex-direction: row-reverse;
        }

        .message.user-message .message-content {
            background-color: rgba(0, 169, 157, 0.2);
            border-color: var(--primary-blue);
        }

        .message-sender {
            font-weight: 600;
            color: var(--primary-blue);
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .message-text {
            color: var(--text-light);
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .message-text p {
            margin: 0 0 10px 0;
        }

        .message-text p:last-child {
            margin-bottom: 0;
        }

        .chat-input-container {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        #chat-action-btn {
            background-color: var(--container-bg-light);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            font-size: 1.3rem;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        #chat-action-btn:hover {
            background-color: var(--primary-blue);
            color: white;
            transform: scale(1.1);
        }

        .chat-input {
            flex: 1;
            background-color: var(--container-bg-light);
            border: 1px solid var(--border-color);
            border-radius: 25px;
            padding: 12px 20px;
            color: var(--text-light);
            font-size: 1rem;
            resize: none;
            min-height: 45px;
            max-height: 120px;
            font-family: 'Poppins', sans-serif;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-blue);
        }

        .send-btn {
            background-color: var(--primary-blue);
            border: none;
            color: white;
            font-size: 1.2rem;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .send-btn:hover {
            background-color: #008f85;
            transform: scale(1.1);
        }

        .send-btn:active {
            transform: scale(0.95);
        }

        /* Calendar Page */
        .calendar-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 25px;
            height: calc(100vh - 200px);
        }

        .calendar-main {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .calendar-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .mini-calendar-card {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--border-color);
        }

        .agenda-card {
            background-color: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid var(--border-color);
            flex: 1;
            overflow-y: auto;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .calendar-header h2 {
            margin: 0;
            font-size: 1.5rem;
            color: var(--text-dark);
        }

        .view-toggle {
            display: flex;
            gap: 5px;
            background-color: var(--container-bg-light);
            border-radius: 25px;
            padding: 5px;
        }

        .view-btn {
            padding: 8px 18px;
            background-color: transparent;
            color: var(--text-light);
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .view-btn.active {
            background-color: var(--primary-blue);
            color: white;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
            margin-top: 15px;
        }

        .calendar-day-header {
            text-align: center;
            padding: 10px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .calendar-day {
            aspect-ratio: 1;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            background-color: var(--container-bg-light);
        }

        .calendar-day:hover {
            background-color: rgba(0, 169, 157, 0.1);
            border-color: var(--primary-blue);
        }

        .calendar-day.today {
            background-color: rgba(0, 169, 157, 0.2);
            border: 2px solid var(--primary-blue);
        }

        .calendar-day.selected {
            background-color: rgba(0, 169, 157, 0.3);
            border: 2px solid var(--primary-blue);
        }

        .calendar-day.other-month {
            opacity: 0.4;
        }

        .calendar-day-number {
            font-weight: 500;
            color: var(--text-dark);
            font-size: 0.9rem;
        }

        .calendar-day-events {
            margin-top: 5px;
            font-size: 0.7rem;
            color: var(--text-light);
        }

        .event-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background-color: var(--primary-blue);
            display: inline-block;
            margin-right: 3px;
        }

        /* Mini Calendar */
        .mini-calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .mini-calendar-header h3 {
            margin: 0;
            font-size: 1.1rem;
            color: var(--text-dark);
        }

        .mini-calendar-nav {
            display: flex;
            gap: 5px;
        }

        .mini-calendar-nav button {
            background-color: var(--container-bg-light);
            border: 1px solid var(--border-color);
            color: var(--text-light);
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mini-calendar-nav button:hover {
            background-color: var(--primary-blue);
            color: white;
        }

        .mini-calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .mini-calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            font-size: 0.85rem;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mini-calendar-day:hover {
            background-color: rgba(0, 169, 157, 0.2);
        }

        .mini-calendar-day.today {
            background-color: var(--primary-blue);
            color: white;
            font-weight: 600;
        }

        .mini-calendar-day.has-event {
            position: relative;
        }

        .mini-calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 2px;
            width: 4px;
            height: 4px;
            background-color: var(--primary-blue);
            border-radius: 50%;
        }

        /* Agenda Panel */
        .agenda-events {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .event {
            background-color: var(--container-bg-light);
            border-left: 4px solid var(--primary-blue);
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .event:hover {
            background-color: rgba(0, 169, 157, 0.15);
            transform: translateX(5px);
        }

        .event-milestone {
            border-left-color: #ff6b6b;
        }

        .event-time {
            font-size: 0.85rem;
            color: var(--primary-blue);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .event-title {
            font-size: 1rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        /* Tools Page */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: var(--container-bg);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tool-card::before {
            content: '';
            position: absolute;
            top: 0; right: 0;
            width: 100px;
            height: 100px;
            background: radial-gradient(circle, rgba(0, 169, 157, 0.2), transparent);
            border-radius: 50%;
            transform: translate(30%, -30%);
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
            border-color: var(--primary-blue);
        }

        .tool-icon {
            font-size: 2.5rem;
            color: var(--primary-blue);
            margin-bottom: 15px;
        }

        .tool-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 10px;
        }

        .tool-description {
            font-size: 0.95rem;
            color: var(--text-light);
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .tool-action-btn {
            padding: 10px 20px;
            background-color: var(--primary-blue);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            width: 100%;
        }

        .tool-action-btn:hover {
            background-color: #008f85;
            transform: scale(1.02);
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--container-bg);
            backdrop-filter: blur(30px);
            border-radius: 15px;
            border: 1px solid var(--border-color);
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            margin: 0;
            color: var(--text-dark);
            font-size: 1.5rem;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.8rem;
            color: var(--text-light);
            cursor: pointer;
            transition: color 0.3s ease;
            padding: 0;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-modal:hover {
            color: #ff6b6b;
        }

        .modal-body {
            color: var(--text-light);
            line-height: 1.6;
        }

        .modal-actions {
            margin-top: 25px;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 10px 25px;
            border-radius: 25px;
            border: none;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .modal-btn.primary {
            background-color: var(--primary-blue);
            color: white;
        }

        .modal-btn.primary:hover {
            background-color: #008f85;
        }

        .modal-btn.secondary {
            background-color: var(--container-bg-light);
            color: var(--text-light);
            border: 1px solid var(--border-color);
        }

        .modal-btn.secondary:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        /* Persona Selection in Modal */
        .persona-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .persona-option {
            background-color: var(--container-bg-light);
            border: 2px solid transparent;
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .persona-option:hover {
            border-color: var(--primary-blue);
            background-color: rgba(0, 169, 157, 0.1);
        }

        .persona-option.selected {
            border-color: var(--primary-blue);
            background-color: rgba(0, 169, 157, 0.2);
        }

        .persona-option img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin-bottom: 10px;
            border: 2px solid var(--primary-blue);
        }

        .persona-option h4 {
            margin: 0;
            font-size: 1rem;
            color: var(--text-dark);
        }

        .persona-option p {
            margin: 5px 0 0 0;
            font-size: 0.85rem;
            color: var(--text-light);
            opacity: 0.8;
        }

        /* Ask Agent Button */
        #ask-agent-btn {
            display: none;
            position: absolute;
            background-color: var(--primary-blue);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 500;
            z-index: 800;
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
        }

        #ask-agent-btn:hover {
            background-color: #008f85;
            transform: scale(1.05);
        }

        /* Meeting List in Modal */
        .meeting-item {
            background-color: var(--container-bg-light);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .meeting-item:hover {
            background-color: rgba(0, 169, 157, 0.15);
            border-color: var(--primary-blue);
        }

        .meeting-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 5px;
            font-size: 1rem;
        }

        .meeting-time {
            font-size: 0.9rem;
            color: var(--text-light);
            opacity: 0.8;
        }

        /* Dropdown header */
        .dropdown-header {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary-blue);
            margin: 20px 0 10px 0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Topic Pills in Modal */
        .modal-pills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 10px;
        }

        .modal-topic-pill {
            background-color: var(--container-bg-light);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9rem;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-topic-pill:hover {
            background-color: var(--primary-blue);
            border-color: var(--primary-blue);
            color: white;
        }

        /* Quick Actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .quick-action-btn {
            flex: 1;
            min-width: 200px;
            padding: 15px 20px;
            background: linear-gradient(135deg, rgba(0, 169, 157, 0.2), rgba(0, 79, 88, 0.3));
            backdrop-filter: blur(15px);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
        }

        .quick-action-btn:hover {
            background: linear-gradient(135deg, var(--primary-blue), #00d4c7);
            color: white;
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .quick-action-btn i {
            font-size: 1.5rem;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .agent-container {
                grid-template-columns: 300px 1fr;
            }
            
            .calendar-layout {
                grid-template-columns: 1fr 300px;
            }
        }

        @media (max-width: 992px) {
            .grid.two-col,
            .grid.three-col,
            .grid.four-col {
                grid-template-columns: 1fr;
            }

            .agent-container {
                grid-template-columns: 1fr;
                height: auto;
            }

            .personas-panel {
                max-height: none;
            }

            .calendar-layout {
                grid-template-columns: 1fr;
            }

            .calendar-sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 10px 20px;
            }

            .header-left span {
                display: none;
            }

            .mobile-menu-btn {
                display: block;
                background: none;
                border: none;
                color: var(--text-light);
                font-size: 1.5rem;
                cursor: pointer;
            }

            .nav-tabs-container {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 250px;
                height: calc(100vh - 70px);
                background-color: var(--container-bg);
                backdrop-filter: blur(30px);
                border-right: 1px solid var(--border-color);
                transition: left 0.3s ease;
                z-index: 950;
                padding: 20px 0;
            }

            .nav-tabs-container.active {
                left: 0;
            }

            .nav-tabs {
                flex-direction: column;
                gap: 0;
            }

            .nav-tab {
                width: 100%;
                text-align: left;
                padding: 15px 20px;
                border-bottom: none;
            }

            .nav-tab::after {
                display: none;
            }

            .container {
                padding: 15px;
            }

            .topics-grid,
            .tools-grid {
                grid-template-columns: 1fr;
            }

            .quick-action-btn {
                min-width: 100%;
            }

            .chat-input-container {
                padding: 15px;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .header-right .user-profile span {
                display: none;
            }

            .stat-value {
                font-size: 2rem;
            }

            .card-title {
                font-size: 1.2rem;
            }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-blue);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #008f85;
        }

        /* Loading State */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-blue);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Utility Classes */
        .text-primary { color: var(--primary-blue); }
        .text-muted { opacity: 0.7; }
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <img src="https://hrsd.gov.sa/themes/custom/saudihrsdfund/logo-ar.svg" alt="HRSD Logo" class="hrsd-logo">
            <span>AI Executive Office</span>
        </div>
        <div class="header-right">
            <button class="mobile-menu-btn" id="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            <div class="user-profile">
                <img src="https://i.pravatar.cc/150?img=33" alt="User">
                <span>Executive</span>
            </div>
            <button><i class="fas fa-cog"></i></button>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="nav-tabs-container" id="nav-tabs-container">
        <div class="nav-tabs">
            <button class="nav-tab active" data-target="dashboard-page">
                <i class="fas fa-chart-line"></i> Dashboard
            </button>
            <button class="nav-tab" data-target="agent-page">
                <i class="fas fa-robot"></i> AI Agent
            </button>
            <button class="nav-tab" data-target="calendar-page">
                <i class="fas fa-calendar-alt"></i> Calendar
            </button>
            <button class="nav-tab" data-target="tools-page">
                <i class="fas fa-tools"></i> AI Tools
            </button>
        </div>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page-content active">
            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="quick-action-btn" data-action="call">
                    <i class="fas fa-phone"></i>
                    <span>Voice Call Agent</span>
                </button>
                <button class="quick-action-btn" data-action="agenda">
                    <i class="fas fa-list-check"></i>
                    <span>Today's Agenda</span>
                </button>
            </div>

            <!-- Quick Stats -->
            <div class="quick-stats">
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-users"></i></div>
                    <div class="stat-value">14</div>
                    <div class="stat-label">Active Projects</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                    <div class="stat-value">8</div>
                    <div class="stat-label">Meetings Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-tasks"></i></div>
                    <div class="stat-value">23</div>
                    <div class="stat-label">Pending Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon"><i class="fas fa-chart-line"></i></div>
                    <div class="stat-value">87%</div>
                    <div class="stat-label">Goals Completion</div>
                </div>
            </div>

            <!-- Focus Areas -->
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-bullseye"></i>
                    Key Focus Areas
                </div>
                <div class="topics-grid">
                    <!-- Topic Card 1 -->
                    <div class="topic-card" data-topic-id="digital-transformation">
                        <div class="topic-header">
                            <div class="topic-icon"><i class="fas fa-laptop-code"></i></div>
                            <div class="topic-status">In Progress</div>
                        </div>
                        <div class="topic-title">Digital Transformation</div>
                        <div class="topic-description">
                            Modernizing HR systems and implementing AI-driven solutions for enhanced employee experience.
                        </div>
                        <div class="topic-actions">
                            <button class="topic-action-btn" data-action="meetings">
                                <i class="fas fa-calendar"></i> Meetings
                            </button>
                            <button class="topic-action-btn" data-action="deeper">
                                <i class="fas fa-search-plus"></i> Dig Deeper
                            </button>
                            <button class="topic-action-btn" data-action="references">
                                <i class="fas fa-file-alt"></i> References
                            </button>
                        </div>
                    </div>

                    <!-- Topic Card 2 -->
                    <div class="topic-card" data-topic-id="workforce-development">
                        <div class="topic-header">
                            <div class="topic-icon"><i class="fas fa-user-graduate"></i></div>
                            <div class="topic-status">Active</div>
                        </div>
                        <div class="topic-title">Workforce Development</div>
                        <div class="topic-description">
                            Strategic initiatives to upskill employees and align talent with future organizational needs.
                        </div>
                        <div class="topic-actions">
                            <button class="topic-action-btn" data-action="meetings">
                                <i class="fas fa-calendar"></i> Meetings
                            </button>
                            <button class="topic-action-btn" data-action="deeper">
                                <i class="fas fa-search-plus"></i> Dig Deeper
                            </button>
                            <button class="topic-action-btn" data-action="references">
                                <i class="fas fa-file-alt"></i> References
                            </button>
                        </div>
                    </div>

                    <!-- Topic Card 3 -->
                    <div class="topic-card" data-topic-id="policy-reform">
                        <div class="topic-header">
                            <div class="topic-icon"><i class="fas fa-balance-scale"></i></div>
                            <div class="topic-status">Planning</div>
                        </div>
                        <div class="topic-title">Policy Reform</div>
                        <div class="topic-description">
                            Reviewing and updating organizational policies to meet evolving regulatory requirements.
                        </div>
                        <div class="topic-actions">
                            <button class="topic-action-btn" data-action="meetings">
                                <i class="fas fa-calendar"></i> Meetings
                            </button>
                            <button class="topic-action-btn" data-action="deeper">
                                <i class="fas fa-search-plus"></i> Dig Deeper
                            </button>
                            <button class="topic-action-btn" data-action="references">
                                <i class="fas fa-file-alt"></i> References
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Performance Overview -->
            <div class="grid two-col mt-20">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-bar"></i>
                        Performance Overview
                    </div>
                    <div class="chart-container">
                        <canvas id="performance-chart"></canvas>
                    </div>
                </div>
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-bullseye"></i>
                        Goal Progress
                    </div>
                    <div class="chart-container">
                        <canvas id="goal-chart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Agent Page -->
        <div id="agent-page" class="page-content">
            <div class="agent-container">
                <!-- Personas Panel -->
                <div class="personas-panel">
                    <h3 style="margin-top: 0; color: var(--text-dark);">AI Assistants</h3>
                    
                    <!-- Persona 1: Executive Agent -->
                    <div class="persona-card active" data-persona="hakim">
                        <div class="persona-header">
                            <img src="https://i.pravatar.cc/150?img=12" alt="Hakim" class="persona-avatar">
                            <div class="persona-info">
                                <h3>Hakim</h3>
                                <p>Executive Agent</p>
                            </div>
                        </div>
                        <div class="persona-description">
                            Your strategic advisor providing executive-level insights, decision support, and organizational intelligence.
                        </div>
                    </div>

                    <!-- Persona 2: Data Analyst -->
                    <div class="persona-card" data-persona="layla">
                        <div class="persona-header">
                            <img src="https://i.pravatar.cc/150?img=45" alt="Layla" class="persona-avatar">
                            <div class="persona-info">
                                <h3>Layla</h3>
                                <p>Data Analyst</p>
                            </div>
                        </div>
                        <div class="persona-description">
                            Specializes in data analysis, visualization, and predictive insights to drive informed decisions.
                        </div>
                    </div>

                    <!-- Persona 3: Meeting Coordinator -->
                    <div class="persona-card" data-persona="omar">
                        <div class="persona-header">
                            <img src="https://i.pravatar.cc/150?img=68" alt="Omar" class="persona-avatar">
                            <div class="persona-info">
                                <h3>Omar</h3>
                                <p>Coordinator</p>
                            </div>
                        </div>
                        <div class="persona-description">
                            Manages scheduling, coordinates meetings, and ensures seamless communication across teams.
                        </div>
                    </div>
                </div>

                <!-- Chat Panel -->
                <div class="chat-panel">
                    <div class="chat-header">
                        <div class="chat-header-left">
                            <h2 id="chat-agent-name">Hakim - Executive Agent</h2>
                            <p id="chat-agent-role">Strategic Advisor & Decision Support</p>
                        </div>
                        <button class="change-persona-btn" id="change-persona-btn">
                            <i class="fas fa-exchange-alt"></i> Change Agent
                        </button>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <!-- Initial greeting message -->
                        <div class="message agent-message">
                            <img src="https://i.pravatar.cc/150?img=12" alt="Agent" class="message-avatar">
                            <div class="message-content">
                                <div class="message-sender">Hakim</div>
                                <div class="message-text">
                                    <p>Good morning! I'm Hakim, your Executive Agent. I'm here to provide strategic insights, help with decision-making, and keep you informed on key organizational matters.</p>
                                    <p>What can I assist you with today?</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <button id="chat-action-btn" title="Quick Actions">
                            <i class="fas fa-plus"></i>
                        </button>
                        <textarea 
                            class="chat-input" 
                            id="chat-input" 
                            placeholder="Type your message..."
                            rows="1"
                        ></textarea>
                        <button class="send-btn" id="send-btn">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Calendar Page -->
        <div id="calendar-page" class="page-content">
            <div class="calendar-layout">
                <!-- Main Calendar -->
                <div class="calendar-main">
                    <div class="calendar-header">
                        <h2 id="calendar-month-year">October 2025</h2>
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="month">Month</button>
                            <button class="view-btn" data-view="week">Week</button>
                            <button class="view-btn" data-view="day">Day</button>
                        </div>
                    </div>
                    
                    <!-- Month View -->
                    <div id="month-view" class="calendar-view">
                        <div class="calendar-grid">
                            <div class="calendar-day-header">Sun</div>
                            <div class="calendar-day-header">Mon</div>
                            <div class="calendar-day-header">Tue</div>
                            <div class="calendar-day-header">Wed</div>
                            <div class="calendar-day-header">Thu</div>
                            <div class="calendar-day-header">Fri</div>
                            <div class="calendar-day-header">Sat</div>
                            <!-- Calendar days will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Calendar Sidebar -->
                <div class="calendar-sidebar">
                    <!-- Mini Calendar -->
                    <div class="mini-calendar-card">
                        <div class="mini-calendar-header">
                            <h3 id="mini-calendar-month">October</h3>
                            <div class="mini-calendar-nav">
                                <button id="mini-cal-prev"><i class="fas fa-chevron-left"></i></button>
                                <button id="mini-cal-next"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        <div class="mini-calendar-grid" id="mini-calendar-grid">
                            <!-- Mini calendar days will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Today's Agenda -->
                    <div class="agenda-card">
                        <h3 style="margin-top: 0; color: var(--text-dark);">Today's Agenda</h3>
                        <div class="agenda-events" id="agenda-events">
                            <!-- Events will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Page -->
        <div id="tools-page" class="page-content">
            <div class="card mb-20">
                <div class="card-title">
                    <i class="fas fa-magic"></i>
                    AI-Powered Tools
                </div>
                <p class="text-muted">Leverage advanced AI capabilities to enhance your productivity and decision-making.</p>
            </div>

            <div class="tools-grid">
                <!-- Tool 1 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-file-alt"></i></div>
                    <div class="tool-title">Document Summarizer</div>
                    <div class="tool-description">
                        Quickly extract key insights from lengthy documents, reports, and briefings.
                    </div>
                    <button class="tool-action-btn" data-tool-action="summarize">Use Tool</button>
                </div>

                <!-- Tool 2 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-chart-pie"></i></div>
                    <div class="tool-title">Data Visualizer</div>
                    <div class="tool-description">
                        Transform complex datasets into intuitive charts and visual representations.
                    </div>
                    <button class="tool-action-btn" data-tool-action="visualize">Use Tool</button>
                </div>

                <!-- Tool 3 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-calendar-plus"></i></div>
                    <div class="tool-title">Smart Scheduler</div>
                    <div class="tool-description">
                        AI-powered meeting coordination that finds optimal times for all participants.
                    </div>
                    <button class="tool-action-btn" data-tool-action="schedule">Use Tool</button>
                </div>

                <!-- Tool 4 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-brain"></i></div>
                    <div class="tool-title">Sentiment Analyzer</div>
                    <div class="tool-description">
                        Analyze team feedback and communications to gauge organizational sentiment.
                    </div>
                    <button class="tool-action-btn" data-tool-action="sentiment">Use Tool</button>
                </div>

                <!-- Tool 5 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-lightbulb"></i></div>
                    <div class="tool-title">Decision Predictor</div>
                    <div class="tool-description">
                        Forecast outcomes and impacts of strategic decisions using predictive analytics.
                    </div>
                    <button class="tool-action-btn" data-tool-action="predict">Use Tool</button>
                </div>

                <!-- Tool 6 -->
                <div class="tool-card">
                    <div class="tool-icon"><i class="fas fa-shield-alt"></i></div>
                    <div class="tool-title">Risk Assessor</div>
                    <div class="tool-description">
                        Identify and evaluate potential risks across projects and initiatives.
                    </div>
                    <button class="tool-action-btn" data-tool-action="risk">Use Tool</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    
    <!-- Event Details Modal -->
    <div id="event-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="event-modal-title">Event Details</h2>
                <button class="close-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <p><strong>Time:</strong> <span id="event-modal-time"></span></p>
                <p id="event-modal-details"></p>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary">Close</button>
                <button class="modal-btn primary">Join Meeting</button>
            </div>
        </div>
    </div>

    <!-- Persona Selection Modal -->
    <div id="persona-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Select AI Assistant</h2>
                <button class="close-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="persona-grid">
                    <div class="persona-option" data-persona="hakim">
                        <img src="https://i.pravatar.cc/150?img=12" alt="Hakim">
                        <h4>Hakim</h4>
                        <p>Executive Agent</p>
                    </div>
                    <div class="persona-option" data-persona="layla">
                        <img src="https://i.pravatar.cc/150?img=45" alt="Layla">
                        <h4>Layla</h4>
                        <p>Data Analyst</p>
                    </div>
                    <div class="persona-option" data-persona="omar">
                        <img src="https://i.pravatar.cc/150?img=68" alt="Omar">
                        <h4>Omar</h4>
                        <p>Coordinator</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Meetings Modal -->
    <div id="meetings-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="meetings-modal-title">Related Meetings</h2>
                <button class="close-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="meetings-modal-list">
                    <!-- Meetings will be populated dynamically -->
                </div>
            </div>
        </div>
    </div>

    <!-- Summary Modal -->
    <div id="summary-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="summary-modal-title">Today's Agenda Summary</h2>
                <button class="close-modal"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="summary-content">
                    <!-- Summary will be populated dynamically -->
                </div>
            </div>
            <div class="modal-actions">
                <button class="modal-btn secondary">Close</button>
                <button class="modal-btn primary" id="copy-summary-btn">
                    <i class="fas fa-copy"></i> Copy to Clipboard
                </button>
            </div>
        </div>
    </div>

    <!-- Message Modal (for notifications) -->
    <div id="message-modal" class="modal">
        <div class="modal-content" style="max-width: 400px; text-align: center;">
            <div class="modal-body">
                <p id="message-modal-text" style="font-size: 1.1rem; margin: 0;"></p>
            </div>
            <div class="modal-actions" style="justify-content: center;">
                <button class="modal-btn primary">OK</button>
            </div>
        </div>
    </div>

    <!-- Ask Agent Button (appears on text selection) -->
    <div id="ask-agent-btn">
        <i class="fas fa-comment-dots"></i> Ask Agent
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Global Variables ---
            const navButtons = document.querySelectorAll('.nav-tab');
            const pages = document.querySelectorAll('.page-content');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const navTabsContainer = document.getElementById('nav-tabs-container');
            
            // Chat elements
            const chatMessages = document.getElementById('chat-messages');
            const chatInput = document.getElementById('chat-input');
            const sendBtn = document.getElementById('send-btn');
            const chatAgentName = document.getElementById('chat-agent-name');
            const chatAgentRole = document.getElementById('chat-agent-role');
            const personaCards = document.querySelectorAll('.persona-card');
            const changePersonaBtn = document.getElementById('change-persona-btn');
            const chatActionBtn = document.getElementById('chat-action-btn');
            
            // Modals
            const eventModal = document.getElementById('event-modal');
            const personaModal = document.getElementById('persona-modal');
            const meetingsModal = document.getElementById('meetings-modal');
            const summaryModal = document.getElementById('summary-modal');
            const messageModal = document.getElementById('message-modal');
            const closeModalBtns = document.querySelectorAll('.close-modal');
            const copySummaryBtn = document.getElementById('copy-summary-btn');
            
            // Calendar elements
            const monthView = document.getElementById('month-view');
            const calendarMonthYear = document.getElementById('calendar-month-year');
            const miniCalendarGrid = document.getElementById('mini-calendar-grid');
            const miniCalendarMonth = document.getElementById('mini-calendar-month');
            const miniCalPrev = document.getElementById('mini-cal-prev');
            const miniCalNext = document.getElementById('mini-cal-next');
            const agendaEvents = document.getElementById('agenda-events');
            
            // Ask Agent button
            const askAgentBtn = document.getElementById('ask-agent-btn');
            let selectedText = '';
            
            // Persona data
            const personasData = {
                hakim: {
                    name: 'Hakim',
                    role: 'Executive Agent',
                    description: 'Strategic Advisor & Decision Support',
                    avatar: 'https://i.pravatar.cc/150?img=12',
                    greeting: "Good morning! I'm Hakim, your Executive Agent. I'm here to provide strategic insights, help with decision-making, and keep you informed on key organizational matters. What can I assist you with today?"
                },
                layla: {
                    name: 'Layla',
                    role: 'Data Analyst',
                    description: 'Data Analysis & Insights Specialist',
                    avatar: 'https://i.pravatar.cc/150?img=45',
                    greeting: "Hello! I'm Layla, your Data Analyst. I specialize in turning complex data into actionable insights. Whether you need visualizations, predictive analytics, or data-driven recommendations, I'm here to help. What data would you like to explore?"
                },
                omar: {
                    name: 'Omar',
                    role: 'Coordinator',
                    description: 'Scheduling & Communication Expert',
                    avatar: 'https://i.pravatar.cc/150?img=68',
                    greeting: "Hi there! I'm Omar, your Coordinator. I manage your schedule, coordinate meetings, and ensure smooth communication across your teams. Need help scheduling a meeting or checking your calendar? Let me know!"
                }
            };
            
            let currentPersonaId = 'hakim';
            
            // Sample events data (hidden in dataset attributes)
            const eventsData = [
                { date: '2025-10-22', time: '09:00', title: 'Executive Team Meeting', details: 'Quarterly strategy review and Q4 planning', milestone: false },
                { date: '2025-10-22', time: '11:30', title: 'Digital Transformation Update', details: 'Progress review on AI implementation', milestone: false },
                { date: '2025-10-22', time: '14:00', title: 'Workforce Development Workshop', details: 'Leadership training program kickoff', milestone: false },
                { date: '2025-10-23', time: '10:00', title: 'Policy Review Committee', details: 'Monthly policy compliance review', milestone: false },
                { date: '2025-10-24', time: '13:00', title: 'Stakeholder Presentation', details: 'Vision 2030 initiative progress report', milestone: true },
                { date: '2025-10-25', time: '15:30', title: 'HR Analytics Review', details: 'Dashboard and metrics analysis', milestone: false },
                { date: '2025-10-28', time: '09:30', title: 'Innovation Lab Tour', details: 'Visit to new technology center', milestone: true },
            ];
            
            // --- Utility Functions ---
            function setViewportHeight() {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            }
            window.addEventListener('resize', setViewportHeight);
            
            function openModal(modal) {
                if (modal) {
                    modal.classList.add('show');
                    document.body.style.overflow = 'hidden';
                }
            }
            
            function closeModal(modal) {
                if (modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = '';
                }
            }
            
            function showMessageModal(message) {
                const messageText = document.getElementById('message-modal-text');
                if (messageText && messageModal) {
                    messageText.textContent = message;
                    openModal(messageModal);
                }
            }
            
            // --- Chat Functions ---
            function addMessage(text, sender = 'user') {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                
                const persona = personasData[currentPersonaId];
                const avatar = sender === 'user' ? 'https://i.pravatar.cc/150?img=33' : persona.avatar;
                const senderName = sender === 'user' ? 'You' : persona.name;
                
                messageDiv.innerHTML = `
                    <img src="${avatar}" alt="${senderName}" class="message-avatar">
                    <div class="message-content">
                        <div class="message-sender">${senderName}</div>
                        <div class="message-text">${marked.parse(text)}</div>
                    </div>
                `;
                
                if (chatMessages) {
                    chatMessages.appendChild(messageDiv);
                    chatMessages.scrollTop = chatMessages.scrollHeight;
                }
            }
            
            function simulateAgentResponse(userMessage) {
                setTimeout(() => {
                    const responses = {
                        hakim: [
                            "Based on the current data, I recommend focusing on the digital transformation initiative as it shows the highest ROI potential.",
                            "I've analyzed the key metrics from your dashboard. The 87% goal completion rate is excellent, but we should address the 23 pending tasks to maintain momentum.",
                            "For strategic planning, I suggest we prioritize the three focus areas: Digital Transformation, Workforce Development, and Policy Reform. Each has distinct timelines and resource requirements.",
                        ],
                        layla: [
                            "I can help you visualize that data. Would you like a bar chart, line graph, or pie chart representation?",
                            "Looking at the performance trends, there's a clear upward trajectory in Q3. I can generate a detailed analysis report if needed.",
                            "The data shows interesting patterns. Let me create some visualizations to help illustrate these insights more clearly.",
                        ],
                        omar: [
                            "I've checked your calendar for next week. You have availability on Tuesday at 2 PM and Thursday at 10 AM. Would either of these work for the meeting?",
                            "I can coordinate that meeting for you. I'll send invites to all participants and book the conference room.",
                            "Your schedule for today includes 8 meetings. Would you like me to send you a detailed agenda with preparation notes for each?",
                        ]
                    };
                    
                    const personaResponses = responses[currentPersonaId] || responses.hakim;
                    const response = personaResponses[Math.floor(Math.random() * personaResponses.length)];
                    
                    addMessage(response, 'agent');
                }, 1000);
            }
            
            function handleSendMessage() {
                const message = chatInput?.value.trim();
                if (message && chatInput) {
                    addMessage(message, 'user');
                    chatInput.value = '';
                    simulateAgentResponse(message);
                }
            }
            
            function updatePersonaUI(personaId, skipGreeting = false) {
                currentPersonaId = personaId;
                const persona = personasData[personaId];
                
                if (chatAgentName) chatAgentName.textContent = `${persona.name} - ${persona.role}`;
                if (chatAgentRole) chatAgentRole.textContent = persona.description;
                
                // Update active persona card
                personaCards.forEach(card => {
                    card.classList.toggle('active', card.dataset.persona === personaId);
                });
                
                // Clear chat and add greeting
                if (chatMessages && !skipGreeting) {
                    chatMessages.innerHTML = `
                        <div class="message agent-message">
                            <img src="${persona.avatar}" alt="${persona.name}" class="message-avatar">
                            <div class="message-content">
                                <div class="message-sender">${persona.name}</div>
                                <div class="message-text"><p>${persona.greeting}</p></div>
                            </div>
                        </div>
                    `;
                }
            }
            
            // --- Calendar Functions ---
            let currentDate = new Date(2025, 9, 22); // October 22, 2025
            let selectedDate = new Date(currentDate);
            
            function renderDesktopMonthCalendar() {
                const grid = monthView?.querySelector('.calendar-grid');
                if (!grid) return;
                
                // Keep headers, remove old days
                while (grid.children.length > 7) {
                    grid.removeChild(grid.lastChild);
                }
                
                const year = currentDate.getFullYear();
                const month = currentDate.getMonth();
                if (calendarMonthYear) {
                    calendarMonthYear.textContent = currentDate.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                }
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const daysInPrevMonth = new Date(year, month, 0).getDate();
                
                // Previous month days
                for (let i = firstDay - 1; i >= 0; i--) {
                    const dayNum = daysInPrevMonth - i;
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'calendar-day other-month';
                    dayDiv.innerHTML = `<div class="calendar-day-number">${dayNum}</div>`;
                    grid.appendChild(dayDiv);
                }
                
                // Current month days
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'calendar-day';
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    
                    // Check if today
                    const isToday = dateStr === new Date(2025, 9, 22).toISOString().split('T')[0];
                    if (isToday) dayDiv.classList.add('today');
                    
                    // Check if selected
                    const isSelected = dateStr === selectedDate.toISOString().split('T')[0];
                    if (isSelected) dayDiv.classList.add('selected');
                    
                    // Check for events
                    const dayEvents = eventsData.filter(e => e.date === dateStr);
                    let eventsHTML = '';
                    if (dayEvents.length > 0) {
                        eventsHTML = `<div class="calendar-day-events">${dayEvents.length} event${dayEvents.length > 1 ? 's' : ''}</div>`;
                    }
                    
                    dayDiv.innerHTML = `
                        <div class="calendar-day-number">${day}</div>
                        ${eventsHTML}
                    `;
                    
                    dayDiv.addEventListener('click', () => {
                        selectedDate = new Date(year, month, day);
                        renderDesktopMonthCalendar();
                        renderTodayView();
                    });
                    
                    grid.appendChild(dayDiv);
                }
                
                // Next month days
                const totalCells = grid.children.length - 7;
                const remainingCells = 42 - totalCells;
                for (let day = 1; day <= remainingCells; day++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'calendar-day other-month';
                    dayDiv.innerHTML = `<div class="calendar-day-number">${day}</div>`;
                    grid.appendChild(dayDiv);
                }
            }
            
            function renderTodayView() {
                const dateStr = selectedDate.toISOString().split('T')[0];
                const dayEvents = eventsData.filter(e => e.date === dateStr);
                
                if (!agendaEvents) return;
                
                if (dayEvents.length === 0) {
                    agendaEvents.innerHTML = '<p style="opacity: 0.7; text-align: center; padding: 20px;">No events scheduled for this day</p>';
                    return;
                }
                
                agendaEvents.innerHTML = '';
                dayEvents.forEach(event => {
                    const eventDiv = document.createElement('div');
                    eventDiv.className = 'event';
                    if (event.milestone) eventDiv.classList.add('event-milestone');
                    
                    eventDiv.innerHTML = `
                        <div class="event-time">${event.time}</div>
                        <div class="event-title">${event.title}</div>
                    `;
                    
                    eventDiv.addEventListener('click', () => {
                        openEventModal(event.title, event.time, event.details);
                    });
                    
                    agendaEvents.appendChild(eventDiv);
                });
            }
            
            function openEventModal(title, time, details) {
                const modalTitle = document.getElementById('event-modal-title');
                const modalTime = document.getElementById('event-modal-time');
                const modalDetails = document.getElementById('event-modal-details');
                
                if (modalTitle) modalTitle.textContent = title;
                if (modalTime) modalTime.textContent = time;
                if (modalDetails) modalDetails.textContent = details;
                
                openModal(eventModal);
            }
            
            // Mini calendar functions
            let miniCalDate = new Date(currentDate);
            
            function renderMiniCalendar() {
                if (!miniCalendarGrid) return;
                
                miniCalendarGrid.innerHTML = '';
                const year = miniCalDate.getFullYear();
                const month = miniCalDate.getMonth();
                
                if (miniCalendarMonth) {
                    miniCalendarMonth.textContent = miniCalDate.toLocaleDateString('en-US', { month: 'long' });
                }
                
                // Day headers
                const dayHeaders = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
                dayHeaders.forEach(header => {
                    const headerDiv = document.createElement('div');
                    headerDiv.textContent = header;
                    headerDiv.style.textAlign = 'center';
                    headerDiv.style.fontSize = '0.75rem';
                    headerDiv.style.fontWeight = '600';
                    headerDiv.style.color = 'var(--text-dark)';
                    miniCalendarGrid.appendChild(headerDiv);
                });
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Empty cells for alignment
                for (let i = 0; i < firstDay; i++) {
                    const emptyDiv = document.createElement('div');
                    miniCalendarGrid.appendChild(emptyDiv);
                }
                
                // Days
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayDiv = document.createElement('div');
                    dayDiv.className = 'mini-calendar-day';
                    dayDiv.textContent = day;
                    
                    const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
                    
                    // Check if today
                    if (dateStr === new Date(2025, 9, 22).toISOString().split('T')[0]) {
                        dayDiv.classList.add('today');
                    }
                    
                    // Check for events
                    if (eventsData.some(e => e.date === dateStr)) {
                        dayDiv.classList.add('has-event');
                    }
                    
                    miniCalendarGrid.appendChild(dayDiv);
                }
            }
            
            if (miniCalPrev) {
                miniCalPrev.addEventListener('click', () => {
                    miniCalDate.setMonth(miniCalDate.getMonth() - 1);
                    renderMiniCalendar();
                });
            }
            
            if (miniCalNext) {
                miniCalNext.addEventListener('click', () => {
                    miniCalDate.setMonth(miniCalDate.getMonth() + 1);
                    renderMiniCalendar();
                });
            }
            
            // --- Charts ---
            function initCharts() {
                // Performance Chart
                const perfCtx = document.getElementById('performance-chart');
                if (perfCtx) {
                    new Chart(perfCtx, {
                        type: 'line',
                        data: {
                            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'],
                            datasets: [{
                                label: 'Performance Score',
                                data: [65, 72, 75, 78, 82, 85, 83, 88, 90, 87],
                                borderColor: '#00A99D',
                                backgroundColor: 'rgba(0, 169, 157, 0.1)',
                                tension: 0.4,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: { display: false }
                            },
                            scales: {
                                y: { 
                                    beginAtZero: true,
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e0e0e0' }
                                },
                                x: {
                                    grid: { color: 'rgba(255, 255, 255, 0.1)' },
                                    ticks: { color: '#e0e0e0' }
                                }
                            }
                        }
                    });
                }
                
                // Goal Chart
                const goalCtx = document.getElementById('goal-chart');
                if (goalCtx) {
                    new Chart(goalCtx, {
                        type: 'doughnut',
                        data: {
                            labels: ['Completed', 'In Progress', 'Pending'],
                            datasets: [{
                                data: [87, 10, 3],
                                backgroundColor: ['#00A99D', '#00d4c7', 'rgba(255, 255, 255, 0.2)']
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: { color: '#e0e0e0' }
                                }
                            }
                        }
                    });
                }
            }
            
            // --- Topic Actions ---
            function openMeetingsModal(topicId, topicTitle) {
                const list = document.getElementById('meetings-modal-list');
                const title = document.getElementById('meetings-modal-title');
                
                if (!list || !title) return;
                
                openModal(meetingsModal);
                title.textContent = `Meetings: ${topicTitle}`;
                
                // Filter relevant meetings
                const relevantMeetings = eventsData.filter(event => {
                    const titleLower = event.title.toLowerCase();
                    const topicLower = topicTitle.toLowerCase();
                    return titleLower.includes(topicLower.split(' ')[0]) || 
                           titleLower.includes(topicLower.split(' ')[1] || '');
                });
                
                if (relevantMeetings.length === 0) {
                    list.innerHTML = '<p>No related meetings found.</p>';
                    return;
                }
                
                list.innerHTML = '';
                relevantMeetings.forEach(meeting => {
                    const meetingDiv = document.createElement('div');
                    meetingDiv.className = 'meeting-item';
                    
                    const meetingDate = new Date(meeting.date + 'T00:00:00').toLocaleDateString('en-US', {
                        weekday: 'short',
                        month: 'short',
                        day: 'numeric'
                    });
                    
                    meetingDiv.innerHTML = `
                        <div class="meeting-title">${meeting.title}</div>
                        <div class="meeting-time">${meetingDate} - ${meeting.time}</div>
                    `;
                    
                    meetingDiv.addEventListener('click', () => {
                        closeModal(meetingsModal);
                        openEventModal(meeting.title, meeting.time, meeting.details);
                    });
                    
                    list.appendChild(meetingDiv);
                });
            }
            
            function takeActionFromTopic(prompt) {
                // Switch to Agent page
                const agentTab = document.querySelector('[data-target="agent-page"]');
                if (agentTab) agentTab.click();
                
                // Set the prompt and send
                setTimeout(() => {
                    if (chatInput) {
                        chatInput.value = prompt;
                        handleSendMessage();
                    }
                }, 300);
            }
            
            function switchToAgentAndSendPrompt(prompt, targetPersonaId = null) {
                // Switch to Agent page
                const agentTab = document.querySelector('[data-target="agent-page"]');
                if (agentTab) agentTab.click();
                
                setTimeout(() => {
                    // Change persona if specified
                    if (targetPersonaId && targetPersonaId !== currentPersonaId) {
                        updatePersonaUI(targetPersonaId);
                    }
                    
                    // Set and send the prompt
                    if (chatInput) {
                        chatInput.value = prompt;
                        handleSendMessage();
                    }
                }, 300);
            }
            
            // --- Today's Agenda Panel (on Dashboard) ---
            function updateTodaysAgendaPanel() {
                // This would update a dashboard widget showing today's events
                // For now, we'll just log it
                console.log("Today's agenda updated");
            }
            
            // --- Calendar View Toggles ---
            function setupCalendarToggles() {
                const viewButtons = document.querySelectorAll('.view-btn');
                viewButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        viewButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        
                        const view = btn.dataset.view;
                        // In a real app, you'd switch between different calendar views here
                        console.log(`Switched to ${view} view`);
                    });
                });
            }
            
            // --- Agenda Interactions ---
            function setupAgendaInteractions() {
                // Store events in DOM with data attributes for easy access
                const allEvents = [];
                eventsData.forEach(event => {
                    const eventEl = document.createElement('div');
                    eventEl.className = 'event';
                    if (event.milestone) eventEl.classList.add('event-milestone');
                    eventEl.dataset.date = event.date;
                    eventEl.dataset.eventTime = event.time;
                    eventEl.dataset.eventTitle = event.title;
                    eventEl.dataset.eventDetails = event.details;
                    allEvents.push(eventEl);
                });
                
                window.allEventsData = allEvents;
            }
            
            // --- Mobile Calendar ---
            function initMobileCalendar() {
                renderMiniCalendar();
            }
            
            // Render events for selected date
            if (window.allEventsData) {
                function renderEvents(dateStr) { const dayEvents = allEvents.filter(e => e.dataset.date === dateStr); if (dayEvents.length === 0) { agendaEvents.innerHTML = '<p style="opacity: 0.7; text-align: center; padding: 20px;">No events scheduled for this day</p>'; return; } agendaEvents.innerHTML = ''; dayEvents.forEach(eventEl => { const eventDiv = document.createElement('div'); eventDiv.className = 'event'; if (eventEl.classList.contains('event-milestone')) { eventDiv.classList.add('event-milestone'); } eventDiv.innerHTML = `<div class="event-time">${eventEl.dataset.eventTime}</div> <div class="event-title">${eventEl.dataset.eventTitle}</div>`; eventDiv.addEventListener('click', () => { openEventModal(eventEl.dataset.eventTitle, eventEl.dataset.eventTime, eventEl.dataset.eventDetails); }); agendaEvents.appendChild(eventDiv); }); }
                renderCalendar(); renderEvents(selectedDate.toISOString().split('T')[0]);
            }

            // --- Event Listeners & Initialization ---

            // Modal close buttons
            closeModalBtns.forEach(btn => { btn.addEventListener('click', () => { const modal = btn.closest('.modal'); if (modal) closeModal(modal); }); });
            window.addEventListener('click', (event) => { if (event.target.classList.contains('modal')) { closeModal(event.target); } });
            // Copy summary button
            if (copySummaryBtn) { copySummaryBtn.addEventListener('click', () => { const contentToCopy = summaryContent ? summaryContent.innerText : ''; if (contentToCopy) { const textArea = document.createElement("textarea"); textArea.value = contentToCopy; textArea.style.position = "fixed"; textArea.style.left = "-9999px"; document.body.appendChild(textArea); textArea.focus(); textArea.select(); try { document.execCommand('copy'); showMessageModal('Agenda copied to clipboard!'); } catch (err) { console.error('Fallback copy failed', err); showMessageModal('Copying failed.'); } document.body.removeChild(textArea); } else { showMessageModal('Nothing to copy.'); } }); }
            // Persona change button
            if (changePersonaBtn) { changePersonaBtn.addEventListener('click', () => openModal(personaModal)); }
            // Send button and Enter key
            if (sendBtn) { sendBtn.addEventListener('click', handleSendMessage); }
            if (chatInput) { chatInput.addEventListener('keydown', (event) => { if (event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); handleSendMessage(); } }); }
            // Topic card actions
            document.querySelectorAll('.topic-action-btn').forEach(button => { button.addEventListener('click', () => { const action = button.dataset.action; const card = button.closest('.topic-card'); if (!card) return; const topicId = card.dataset.topicId; const topicTitleEl = card.querySelector('.topic-title'); if (!topicTitleEl) return; const topicTitle = topicTitleEl.textContent; if (action === 'meetings') { openMeetingsModal(topicId, topicTitle); } else if (action === 'deeper') { const prompt = `Can you dig deeper into the topic of "${topicTitle}" for me? Provide key details and current status.`; takeActionFromTopic(prompt); } else if (action === 'references') { const prompt = `Please pull up the latest references and documents from my team regarding "${topicTitle}".`; takeActionFromTopic(prompt); } }); });
            // "Ask Agent" on text selection
             document.addEventListener('mouseup', (e) => { if (!askAgentBtn) return; const targetElement = e.target; if (targetElement.tagName === 'INPUT' || targetElement.tagName === 'TEXTAREA' || targetElement.closest('.modal') || targetElement.closest('#ask-agent-btn')) { askAgentBtn.style.display = 'none'; return; } setTimeout(() => { const text = window.getSelection().toString().trim(); if (text.length > 1) { selectedText = text; const rect = window.getSelection().getRangeAt(0).getBoundingClientRect(); askAgentBtn.style.left = `${rect.right + window.scrollX + 5}px`; askAgentBtn.style.top = `${rect.bottom + window.scrollY + 5}px`; askAgentBtn.style.display = 'block'; } else { askAgentBtn.style.display = 'none'; } }, 10); });
            document.addEventListener('mousedown', (e) => { if (askAgentBtn && e.target.id !== 'ask-agent-btn') { askAgentBtn.style.display = 'none'; } });
            if (askAgentBtn) { askAgentBtn.addEventListener('click', (e) => { e.stopPropagation(); if (selectedText) { const prompt = `Please provide more details about the following text I selected: "${selectedText}"`; switchToAgentAndSendPrompt(prompt); selectedText = ''; } askAgentBtn.style.display = 'none'; }); }
            // Mobile menu toggle
            if (mobileMenuBtn) { mobileMenuBtn.addEventListener('click', () => { if (navTabsContainer) navTabsContainer.classList.toggle('active'); }); }
            // Quick Actions
            document.querySelectorAll('.quick-action-btn').forEach(btn => { btn.addEventListener('click', () => { const action = btn.dataset.action; let prompt = ''; switch(action) { case 'call': showMessageModal("Voice call feature not implemented in this demo."); return; case 'agenda': prompt = "Please provide a detailed overview of my agenda for today, including all scheduled meetings and key tasks."; break; } if (prompt && chatInput) { chatInput.value = prompt; handleSendMessage(); } }); });
            // Chat "+" Action Button
             chatActionBtn?.addEventListener('click', (e) => { e.stopPropagation(); const list = document.getElementById('meetings-modal-list'); const title = document.getElementById('meetings-modal-title'); if (!list || !title) { console.error("Meetings modal elements not found"); return; } openModal(meetingsModal); list.innerHTML = ''; title.textContent = `Discuss a Topic`; let content = '<div class="dropdown-header">Discuss a Focus Area</div><div class="modal-pills-container">'; document.querySelectorAll('.topic-card .topic-title').forEach(titleEl => { content += `<div class="modal-topic-pill chat-action-item" data-prompt="Let's discuss the focus area: ${titleEl.textContent}">${titleEl.textContent}</div>`; }); content += '</div>'; content += '<div class="dropdown-header">Discuss a Meeting</div>'; const events = document.querySelectorAll('.event[data-date]'); if (events.length > 0) { events.forEach(event => { const eventTitle = event.dataset.eventTitle || 'Unnamed Meeting'; const eventTime = event.dataset.eventTime || 'No time'; const eventDateStr = event.dataset.date; if(eventDateStr) { const eventDate = new Date(eventDateStr + 'T00:00:00').toLocaleDateString('en-US', { weekday: 'short', month: 'short', day: 'numeric' }); content += `<div class="meeting-item chat-action-item" data-prompt="What should I know about the meeting: ${eventTitle}?"><div class="meeting-title">${eventTitle}</div><div class="meeting-time">${eventDate} - ${eventTime}</div></div>`; } }); } else { content += '<p>No meetings found.</p>'; } list.innerHTML = content; list.querySelectorAll('.chat-action-item').forEach(item => { item.addEventListener('click', (ev) => { ev.preventDefault(); if (chatInput && item.dataset.prompt) { chatInput.value = item.dataset.prompt; handleSendMessage(); } closeModal(meetingsModal); }); }); });

             // --- Updated Tool Card Actions ---
             document.querySelectorAll('.tool-action-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const action = button.dataset.toolAction;
                    const card = button.closest('.tool-card');
                    if (!card) return;
                    const toolTitleEl = card.querySelector('.tool-title');
                    if (!toolTitleEl) return;
                    const toolTitle = toolTitleEl.textContent;

                    let targetPersonaId = 'hakim'; // Default
                    let prompt = `Tell me more about how I can use the "${toolTitle}" AI tool.`;

                    // Assign persona and craft prompt based on the tool action
                    switch(action) {
                        case 'visualize':
                        case 'predict':
                        case 'sentiment':
                            targetPersonaId = 'layla'; // Data Analyst
                            prompt = `Please assist me with ${toolTitle}. What data do you need to get started?`;
                            break;
                        case 'summarize':
                            targetPersonaId = 'hakim'; // Executive Agent
                            prompt = `I need help using the ${toolTitle} tool. Can you guide me or perform a summarization task?`;
                            break;
                        case 'schedule':
                            targetPersonaId = 'omar'; // Coordinator
                            prompt = `I need to schedule a meeting using the ${toolTitle}. Please help me coordinate.`;
                            break;
                        case 'risk':
                            targetPersonaId = 'hakim'; // Executive Agent (strategic risk)
                            // Or potentially Layla if focused on data-driven risk: targetPersonaId = 'layla';
                            prompt = `I need to use the ${toolTitle} tool. Can you help me assess risks related to [Specify Area/Project]?`;
                            break;
                        default:
                             prompt = `Tell me more about the "${toolTitle}" tool.`;
                    }

                    // Switch persona (if needed) and send the prompt
                    switchToAgentAndSendPrompt(prompt, targetPersonaId);
                });
            });


             // --- Corrected Navigation Logic ---
             if (navButtons && pages) {
                 navButtons.forEach(button => {
                     button.addEventListener('click', () => {
                         const targetId = button.dataset.target;
                         const targetPage = document.getElementById(targetId);

                         // Hide all pages first
                         pages.forEach(page => {
                             if (page) page.classList.remove('active');
                         });

                         // Show the target page if found
                         if (targetPage) {
                             targetPage.classList.add('active');
                         } else {
                             console.error(`Target page with ID "${targetId}" not found.`);
                         }

                         // Update button active state
                         navButtons.forEach(btn => btn.classList.remove('active'));
                         button.classList.add('active');

                         // Close mobile nav if open
                         if (navTabsContainer && navTabsContainer.classList.contains('active')) {
                             navTabsContainer.classList.remove('active');
                         }
                     });
                 });
             } else {
                 console.error("Navigation buttons or page content elements not found.");
             }

            // --- INITIALIZATION ---
            setViewportHeight();
            setupCalendarToggles(); // Should be defined before call now
            updatePersonaUI(currentPersonaId, true);
            updateTodaysAgendaPanel();
            setupAgendaInteractions();
            initMobileCalendar();
            renderDesktopMonthCalendar();
            renderTodayView();

        });
    </script>
</body>
</html>
